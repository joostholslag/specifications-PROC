<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="description" content="openEHR Decision Language specification">
<meta name="keywords" content="expressions, rules, workflow">
<title>Decision Support Language (DSL) and Model</title>
<link rel="stylesheet" href="https://specifications.openehr.org/styles/openehr.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_decision_support_language_dsl_and_model">Decision Support Language (DSL) and Model</a>
<ul class="sectlevel1">
<li><a href="#_amendment_record">Amendment Record</a></li>
<li><a href="#_acknowledgements">Acknowledgements</a>
<ul class="sectlevel2">
<li><a href="#_primary_author">Primary Author</a></li>
</ul>
</li>
<li><a href="#_preface">1. Preface</a>
<ul class="sectlevel2">
<li><a href="#_purpose">1.1. Purpose</a></li>
<li><a href="#_related_documents">1.2. Related Documents</a></li>
<li><a href="#_status">1.3. Status</a></li>
<li><a href="#_feedback">1.4. Feedback</a></li>
<li><a href="#_conformance">1.5. Conformance</a></li>
</ul>
</li>
<li><a href="#_requirements">2. Requirements</a>
<ul class="sectlevel2">
<li><a href="#_caller_interaction">2.1. Caller Interaction</a></li>
<li><a href="#_representation">2.2. Representation</a></li>
<li><a href="#_binding_to_data_context">2.3. Binding to Data Context</a></li>
<li><a href="#_type_system">2.4. Type System</a></li>
</ul>
</li>
<li><a href="#_overview">3. Overview</a>
<ul class="sectlevel2">
<li><a href="#_conceptual_model">3.1. Conceptual Model</a></li>
<li><a href="#_prior_art">3.2. Prior Art</a></li>
<li><a href="#_other_standards">3.3. Other Standards</a></li>
</ul>
</li>
<li><a href="#_decision_support_language">4. Decision Support Language</a>
<ul class="sectlevel2">
<li><a href="#_overview_2">4.1. Overview</a></li>
<li><a href="#_structure">4.2. Structure</a></li>
<li><a href="#_definitions">4.3. Definitions</a></li>
<li><a href="#_conditions">4.4. Conditions</a></li>
<li><a href="#_rules">4.5. Rules</a></li>
<li><a href="#_rule_sets">4.6. Rule-sets</a></li>
</ul>
</li>
<li><a href="#_plan_dsm_interaction">5. Plan / DSM Interaction</a>
<ul class="sectlevel2">
<li><a href="#_data_sharing">5.1. Data-sharing</a></li>
<li><a href="#_plan_structure_references_to_dsm_features">5.2. Plan Structure References to DSM Features</a>
<ul class="sectlevel3">
<li><a href="#_rule_based">5.2.1. Rule-based</a></li>
<li><a href="#_condition_based">5.2.2. Condition-based</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_dsm_service_model">6. DSM Service Model</a></li>
<li><a href="#_examples">7. Examples</a>
<ul class="sectlevel2">
<li><a href="#_perinatal_care">7.1. Perinatal Care</a>
<ul class="sectlevel3">
<li><a href="#_proxy_module">7.1.1. Proxy Module</a></li>
<li><a href="#_decision_module">7.1.2. Decision Module</a></li>
</ul>
</li>
<li><a href="#_breast_cancer_decision_protocol">7.2. Breast Cancer Decision Protocol</a>
<ul class="sectlevel3">
<li><a href="#_proxy_module_2">7.2.1. Proxy module</a></li>
<li><a href="#_decision_module_2">7.2.2. Decision Module</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_the_decision_support_language_model_dslm">8. The Decision Support Language Model (DSLM)</a>
<ul class="sectlevel2">
<li><a href="#_overview_3">8.1. Overview</a></li>
<li><a href="#_ds_module_package">8.2. DS Module Package</a>
<ul class="sectlevel3">
<li><a href="#_class_descriptions">8.2.1. Class Descriptions</a>
<ul class="sectlevel4">
<li><a href="#_decision_module_class">8.2.1.1. DECISION_MODULE Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_ds_rules_package">8.3. DS Rules Package</a>
<ul class="sectlevel3">
<li><a href="#_condition_chain_rule">8.3.1. Condition Chain Rule</a></li>
<li><a href="#_case_rule">8.3.2. Case Rule</a></li>
<li><a href="#_class_descriptions_2">8.3.3. Class Descriptions</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_references">References</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock text-center">
<div class="content">
<img src="https://specifications.openehr.org/images/openEHR_logo_RGB.svg" alt="openEHR logo">
</div>
</div>
</div>
</div>
<h1 id="_decision_support_language_dsl_and_model" class="sect0"><a class="anchor" href="#_decision_support_language_dsl_and_model"></a>Decision Support Language (DSL) and Model</h1>
<div class="openblock partintro">
<div class="content">
<table class="tableblock frame-all grid-all fit-content spread">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2"><strong>Issuer</strong>: <a href="https://www.openehr.org/programs/specification" target="_blank" rel="noopener">openEHR Specification Program</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Release</strong>: PROC latest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Status</strong>: DEVELOPMENT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Revision</strong>: <a href="#latest_issue">[latest_issue]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Date</strong>: <a href="#latest_issue_date">[latest_issue_date]</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>Keywords</strong>: expressions, rules, workflow</p></td>
</tr>
</tbody>
</table>
<div class="imageblock text-center">
<div class="content">
<object type="image/svg+xml" data="openehr_block_diagram.svg" width="60%"><span class="alt">openEHR components</span></object>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">&#169; 2020 - 2020 The openEHR Foundation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><a href="https://www.openehr.org" target="_blank" rel="noopener">The openEHR Foundation</a> is an independent, non-profit foundation, facilitating the sharing of health records by consumers and clinicians via open specifications, clinical models and open platform implementations.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Licence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://specifications.openehr.org/images/cc-by-nd-88x31.png" alt="image"></span> Creative Commons Attribution-NoDerivs 3.0 Unported. <a href="https://creativecommons.org/licenses/by-nd/3.0/" class="bare">https://creativecommons.org/licenses/by-nd/3.0/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Support</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Issues: <a href="https://specifications.openehr.org/components/PROC/open_issues" target="_blank" rel="noopener">Problem Reports</a><br>
 Web: <a href="https://specifications.openehr.org" target="_blank" rel="noopener">specifications.openEHR.org</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_amendment_record"><a class="anchor" href="#_amendment_record"></a>Amendment Record</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 54.5454%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Issue</th>
<th class="tableblock halign-left valign-top">Details</th>
<th class="tableblock halign-left valign-top">Raiser, Implementer</th>
<th class="tableblock halign-left valign-top">Completed</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>PROC Release 2.0.0 (unreleased)</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue"></a>0.5.0</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="https://specifications.openehr.org/tickets/SPECPROC-41" target="_blank" rel="noopener">SPECPROC-41</a>. Add Decision Language specification.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue_date"></a>13 Feb 2020</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements"><a class="anchor" href="#_acknowledgements"></a>Acknowledgements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_primary_author"><a class="anchor" href="#_primary_author"></a>Primary Author</h3>
<div class="ulist">
<ul>
<li>
<p>Thomas Beale, Ars Semantica; openEHR Foundation Management Board.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preface"><a class="anchor" href="#_preface"></a>1. Preface</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose"><a class="anchor" href="#_purpose"></a>1.1. Purpose</h3>
<div class="paragraph">
<p>This document specifies the openEHR Decision Support Language (DSL), in both abstract syntax form and as a related model, the Decision Supoort Language Model (DSLM). The latter defines the semantics of a first order predicate style logic that can be used to write clinical Decision Support Models (DSMs) that may be used standalone or with a Process / Plan oriented system such as <a href="https://specifications.openehr.org/releases/PROC/latest/task_planning.html" target="_blank" rel="noopener">openEHR Task Planning</a>.</p>
</div>
<div class="paragraph">
<p>The intended audience includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Standards bodies producing health informatics standards;</p>
</li>
<li>
<p>Academic groups using openEHR;</p>
</li>
<li>
<p>Solution vendors.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_documents"><a class="anchor" href="#_related_documents"></a>1.2. Related Documents</h3>
<div class="paragraph">
<p>Prerequisite documents for reading this document include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://specifications.openehr.org/releases/BASE/latest/architecture_overview.html" target="_blank" rel="noopener">openEHR Architecture Overview</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Related documents include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://specifications.openehr.org/releases/PROC/latest/task_planning.html" target="_blank" rel="noopener">openEHR Task Planning specification</a>;</p>
</li>
<li>
<p>The <a href="https://specifications.openehr.org/releases/CDS/latest/GDL.html" target="_blank" rel="noopener">Guideline Definition Language (GDL)</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_status"><a class="anchor" href="#_status"></a>1.3. Status</h3>
<div class="paragraph">
<p>This specification is in the DEVELOPMENT state. The development version of this document can be found at <a href="https://specifications.openehr.org/releases/PROC/latest/decision_language.html" target="_blank" rel="noopener">https://specifications.openehr.org/releases/PROC/latest/decision_language.html</a>.</p>
</div>
<div class="paragraph">
<p>Known omissions or questions are indicated in the text with a 'to be determined' paragraph, as follows:</p>
</div>
<div class="paragraph tbd">
<p><strong>TBD</strong>: (example To Be Determined paragraph)</p>
</div>
</div>
<div class="sect2">
<h3 id="_feedback"><a class="anchor" href="#_feedback"></a>1.4. Feedback</h3>
<div class="paragraph">
<p>Feedback may be provided on the <a href="https://discourse.openehr.org/c/specifications" target="_blank" rel="noopener">technical mailing list</a>.</p>
</div>
<div class="paragraph">
<p>Issues may be raised on the <a href="https://specifications.openehr.org/components/PROC/open_issues" target="_blank" rel="noopener">specifications Problem Report tracker</a>.</p>
</div>
<div class="paragraph">
<p>To see changes made due to previously reported issues, see the <a href="https://specifications.openehr.org/components/PROC/history" target="_blank" rel="noopener">PROC component Change Request tracker</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conformance"><a class="anchor" href="#_conformance"></a>1.5. Conformance</h3>
<div class="paragraph">
<p>Conformance of a data or software artifact to an openEHR specification is determined by a formal test of that artifact against the relevant <a href="https://specifications.openehr.org/releases/ITS/latest/index" target="_blank" rel="noopener">openEHR Implementation Technology Specification(s) (ITSs)</a>, such as an IDL interface or an XML-schema. Since ITSs are formal derivations from underlying models, ITS conformance indicates model conformance.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_requirements"><a class="anchor" href="#_requirements"></a>2. Requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The requirements of openEHR Decision Support Language fall into a number of categories, described below.</p>
</div>
<div class="paragraph tbd">
<p>TBD: this section only very rough for now.</p>
</div>
<div class="sect2">
<h3 id="_caller_interaction"><a class="anchor" href="#_caller_interaction"></a>2.1. Caller Interaction</h3>
<div class="ulist">
<ul>
<li>
<p>the ability to capture the reasoning chain for presentation to a caller as a justification;</p>
</li>
<li>
<p>the ability to provide a decision and its possible outcomes, with the current recommendation indicated;</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_representation"><a class="anchor" href="#_representation"></a>2.2. Representation</h3>
<div class="ulist">
<ul>
<li>
<p>multi-lingual translations for symbolic variables, in a similar way to the <a href="https://specifications.openehr.org/releases/AM/latest/ADL2.html" target="_blank" rel="noopener">openEHR Archetype Definition Language (ADL2)</a>;</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_binding_to_data_context"><a class="anchor" href="#_binding_to_data_context"></a>2.3. Binding to Data Context</h3>
<div class="ulist">
<ul>
<li>
<p>bindings that connect variables to external data sources;</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_type_system"><a class="anchor" href="#_type_system"></a>2.4. Type System</h3>
<div class="ulist">
<ul>
<li>
<p>an ability to use externally defined information models that supply types that may be used in DL statements.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>3. Overview</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_conceptual_model"><a class="anchor" href="#_conceptual_model"></a>3.1. Conceptual Model</h3>
<div class="paragraph">
<p>The openEHR Decision Support Language (DSL) and Decision Support Language Model (DSLM) define a formalism for expressing decision logic used in healthcare and biomedical research. Decision logic usually sits within a larger environment of plans, workflows and also data sources such as the EHR. The following diagram illustrates the artefacts covered by this specification within the wider computational context.</p>
</div>
<div id="conceptual_framework_overview" class="imageblock text-center text-center">
<div class="content">
<img src="common/diagrams/conceptual_framework_overview.svg" alt="conceptual framework overview">
</div>
<div class="title">Figure 1. openEHR conceptual framework for computable care pathways</div>
</div>
<div class="paragraph">
<p>In the above, the top part illustrates process and plan definitions, of which the <em>care pathway</em> is a specific example in clinical medicine. In openEHR these are expressed as Work Plans, defined by the <a href="https://specifications.openehr.org/releases/PROC/latest/task_planning.html" target="_blank" rel="noopener">openEHR Task Planning model</a>. In other environments, OMG BPMN/CMMN representation might be used.</p>
</div>
<div class="paragraph">
<p>Below the process component, the two components of the decision support framework decribed in this specification are shown:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Decision Support Module (DSM)</strong>: modules containing decision functions that generate inferences from input variables representing real world entities being reasoned about;</p>
</li>
<li>
<p><strong>Subject Proxy Object (SPO)</strong>: a definition of state variables and events characterising a real-world entity in a convenient form for use in a DSM.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The remaining component (shown at bottom left) is the <em>Data Access Binding (DAB)</em>, which consists of bindings to data sources and repositories, such as patient health records and monitoring devices. Data from these locations is extracted to populate the input variables of a Subject Proxy.</p>
</div>
<div class="paragraph">
<p>In this environment, the Process Definition component may be understood as a primary user of DSMs and SPOs, providing it respectively with access to real world state (e.g. patient vital signs) and the results of inferencing on such state variables. As a consequence (and unlike BPMN), formal expressions do not appear in process definitions, only references to variables and functions.</p>
</div>
<div class="paragraph">
<p>The essential characterisation of <em>decision support logic</em> understood in this specification is a function-oriented logic that generates deductive inferences, such as clinical classification of patients (including diagnosis), from input variables representing known facts about the patient. These include results obtained from real world observation, measurement, imaging etc, as well as previous confirmed diagnosis and records of previous procedures. This specification considers decision support logic to consist of <em>definitions</em>, as well as various logical elements, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>conditions</em>: Boolean-valued simple rules;</p>
</li>
<li>
<p><em>rules</em>: rules generating non-Boolean values;</p>
</li>
<li>
<p><em>rule-sets</em>: collections of rules that operate on a common set of input variables to generate a common set of output values.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Rule-sets may come in various forms, including the <em>decision table</em>, a common way of documenting a set of related rules using a 2-dimensional table.</p>
</div>
<div class="paragraph">
<p>Rules typically contain <em>conditions</em> i.e. Boolean-returning expressions such as <code><em>heart_rate</em> &gt;= 120 /min and <em>heart_rhythm</em> = |irregular|</code> that are used as criteria for choosing decision paths within a function. In many domains, including healthcare, such conditions are often determined by long-term, evidence-based research, and may be well-known within a domain. For example, the innocuous-looking condition <code><em>blood_glucose</em>[2h post 75g glucose challenge] &gt; 6.5 mmol/ml</code> is the diagnostic standard for type I diabetes.</p>
</div>
<div class="paragraph">
<p>Conditions, rules, rule-sets and other inference-generating structures that may include them constitute fragments of knowledge that need to be able to be authored and change-managed independently from contexts that use them, rather than being directly written into (say) if/then/else logic chains as a programmer would typically do. This specification accordingly provides a representational form for such logic, along with artefacts that connect them to data access services (e.g. EHR) and also enable them to be invoked by user contexts (e.g. workflow engines).</p>
</div>
<div class="paragraph">
<p>Decision support logic necessarily requires a way of defining and expressing its <em>input variables</em>. This is not just a question of creating typed variables, but one of semantics. The 'variables' used in rules represent an <em>ontic</em> view of the subject, that is, a true description of its state in reality. For example, a rule for inferring atrial fibrillation and other forms of arrhythmia may refer to the input variables <code><em>heart_rate</em></code> and <code><em>heart_rhythm</em></code>. The meaning of these variables is that they represent the real heart rate and rhythm of the patient, rather than being just any heart rate, e.g. from a measurement 3 years ago. Similarly, a variable <code><em>is_type1_diabetic</em></code> represents a proposition about the patient in reality.</p>
</div>
<div class="paragraph">
<p>A second requirement of rule variables is that they are close to the language of the domain, for example <code><em>is_type1_diabetic</em></code> and <code><em>has_family_history_of_breast_cancer</em></code> are things a clinical professional instantly understands. Semantically, they tend to be highly precoordinated forms of more technical representations, e.g. <code>problem_list.contains (type = 73211009|diabetes mellitus|, status=confirmed)</code>.</p>
</div>
<div class="paragraph">
<p>In order to support the definition of such variables, a connection is of course needed to the technical representation of data found within EHRs, documents, lab messages, real-time devices and other sources. These latter constitute the <em>epistemic</em> knowledge base for extracting the ontic view. They also tend to be highly variable, due to different concrete standards, products and databases. The ability to write decision logic in a natural yet computable way - independent of specific access methods and type systems - thus requires support for various levels of representation above the purely technical data items and APIs found in healthcare information systems. The Subject Proxy component in the scheme illustrated above constitutes the top-most reification of underlying data in the form of domain-comprehensible ontic variables.</p>
</div>
</div>
<div class="sect2">
<h3 id="_prior_art"><a class="anchor" href="#_prior_art"></a>3.2. Prior Art</h3>
<div class="paragraph">
<p>openEHR DSL may be compared to other languages developed in the health arena for expressing 'medical logic', including <a href="https://www.hl7.org/special/Committees/arden/index.cfm" target="_blank" rel="noopener">HL7 Arden Syntax</a>, Guideline Interchange Format (<a href="#GLIF">Ohno-Machado et al.&#44; 1998</a>), ProForma (<a href="#SuttonFox2003">Sutton &amp; Fox&#44; 2003</a>), as well as decision support languages such as <a href="https://www.hl7.org/implement/standards/product_brief.cfm?product_id=5" target="_blank" rel="noopener">HL7 Gello</a>. These languages were not directly used, for various reasons including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>they do not support any distinction of ontic versus epistemic variables;</p>
</li>
<li>
<p>none have an easily extensible value referencing mechanism;</p>
</li>
<li>
<p>some are too procedural (Arden, GLIF);</p>
</li>
<li>
<p>current versions of some of these languages have been made specific to the HL7v3 RIM, a particular (and obsolete) model of health information designed for message representation (GLIF 3.x, GELLO);</p>
</li>
<li>
<p>none of them have a clear separation of the semantics of process representation, decision logic, proxy data and data access;</p>
</li>
<li>
<p>the maintenance and support is unclear and/or limited.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Nevertheless, various elements of Arden provided useful inspiration for the formalism described here. The Data Access Binding described here may be understood as a solution to the so-called 'curly braces problem' of Arden (<a href="#Samwald_arden_2012">Samwald&#44; Fehre&#44; de Bruin&#44; &amp; Adlassnig&#44; 2012</a>), i.e. the need to be able to bind rule logic to real-world variables.</p>
</div>
</div>
<div class="sect2">
<h3 id="_other_standards"><a class="anchor" href="#_other_standards"></a>3.3. Other Standards</h3>
<div class="paragraph">
<p>Other relevant formalisms include the OMG <a href="http://www.bpmn.org/" target="_blank" rel="noopener">BPMN</a>, <a href="https://www.omg.org/spec/CMMN/1.0/" target="_blank" rel="noopener">CMMN</a> and <a href="https://www.omg.org/spec/DMN/" target="_blank" rel="noopener">DMN</a> standards, and the <a href="https://cql.hl7.org" target="_blank" rel="noopener">HL7 CQL standard</a>. The former group of standards are starting (as of 2020) to find use in the healthcare arena, having been developed for other industries including process control, logistics and insurance, and will require further development and integration for use in healthcare. The HL7 CQL standard addresses some of the same issues as openEHR DL/EL.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_decision_support_language"><a class="anchor" href="#_decision_support_language"></a>4. Decision Support Language</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_2"><a class="anchor" href="#_overview_2"></a>4.1. Overview</h3>
<div class="paragraph">
<p>The Decision Support Language is a high-level language in which modules containing the following elements may be written:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>definitions</em>: domain constants;</p>
</li>
<li>
<p><em>conditions</em>: Boolean-returning domain-specified criteria;</p>
</li>
<li>
<p><em>rules</em>: domain-specified rules structures based on condition/action structures, which may return any type;</p>
</li>
<li>
<p><em>rule-sets</em>: related sets of rules in various forms, including decision tables.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An example of a basic DSL text is shown below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>decision_module
    Cardiology_basic

data_source
    P: HeartPatient

definitions
    Afib_heart_rate: Quantity = 120 /min
    High_heart_rate: Quantity = 100 /min

conditions
    has_atrial_fibrillation:
        P.heart_rhythm = |erratic|286761003 and
            P.heart_rate &gt;= Afib_heart_rate

    has_tachycardia:
        P.heart_rate &gt;= High_heart_rate and
              P.exertion = |at rest|263678003

rules
    heart_assessment: Terminology_term
        if has_atrial_fibrillation
            Result &lt;- |atrial fibrillation|49436004

        elseif has_tachycardia
            Result &lt;- |tachycardia|11092001

        else
            Result &lt;- |normal|76863003</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_structure"><a class="anchor" href="#_structure"></a>4.2. Structure</h3>
<div class="paragraph tbd">
<p>TBD:</p>
</div>
</div>
<div class="sect2">
<h3 id="_definitions"><a class="anchor" href="#_definitions"></a>4.3. Definitions</h3>
<div class="paragraph tbd">
<p>TBD:</p>
</div>
</div>
<div class="sect2">
<h3 id="_conditions"><a class="anchor" href="#_conditions"></a>4.4. Conditions</h3>
<div class="paragraph tbd">
<p>TBD:</p>
</div>
</div>
<div class="sect2">
<h3 id="_rules"><a class="anchor" href="#_rules"></a>4.5. Rules</h3>
<div class="paragraph tbd">
<p>TBD:</p>
</div>
</div>
<div class="sect2">
<h3 id="_rule_sets"><a class="anchor" href="#_rule_sets"></a>4.6. Rule-sets</h3>
<div class="paragraph tbd">
<p>TBD:</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_plan_dsm_interaction"><a class="anchor" href="#_plan_dsm_interaction"></a>5. Plan / DSM Interaction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_data_sharing"><a class="anchor" href="#_data_sharing"></a>5.1. Data-sharing</h3>
<div class="paragraph tbd">
<p>TBD: how to transmit arguments: assume all available in data sources? Need to allow calls to DSM using arguments?</p>
</div>
</div>
<div class="sect2">
<h3 id="_plan_structure_references_to_dsm_features"><a class="anchor" href="#_plan_structure_references_to_dsm_features"></a>5.2. Plan Structure References to DSM Features</h3>
<div class="paragraph">
<p>At least two usage styles between the Plan engine and the Decision engine are possible.</p>
</div>
<div class="sect3">
<h4 id="_rule_based"><a class="anchor" href="#_rule_based"></a>5.2.1. Rule-based</h4>
<div class="paragraph">
<p>In this style, rules are defined within the decision logic modules and the Plan just performs a 'switch' on the output values. This would be useful for non-Boolean decisions, e.g. generating coded terms; also for functions generating many possible values or value ranges. A DSM 'rule' is likely to be intentionally designed to reflect published clinical best practice.</p>
</div>
<div id="conceptual_decision_based" class="imageblock text-center text-center">
<div class="content">
<img src="decision_language/diagrams/conceptual_decision_based.svg" alt="conceptual decision based">
</div>
<div class="title">Figure 2. Rule-based interface</div>
</div>
</div>
<div class="sect3">
<h4 id="_condition_based"><a class="anchor" href="#_condition_based"></a>5.2.2. Condition-based</h4>
<div class="paragraph">
<p>In this style, only conditions defined within the logic modules are called, and the Plan defines the decision structure, i.e. it is a novel or ad hoc use of existing conditions. Semantically the</p>
</div>
<div id="conceptual_condition_based" class="imageblock text-center text-center">
<div class="content">
<img src="decision_language/diagrams/conceptual_condition_based.svg" alt="conceptual condition based">
</div>
<div class="title">Figure 3. Condition-based interface</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dsm_service_model"><a class="anchor" href="#_dsm_service_model"></a>6. DSM Service Model</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_examples"><a class="anchor" href="#_examples"></a>7. Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following examples rely on the 'Core Patient' and extension Subject Proxies defined in the <a href="https://specifications.openehr.org/releases/PROC/latest/subject_proxy.html#_core_patient_proxy" target="_blank" rel="noopener">openEHR Subject Proxy Specification</a>.</p>
</div>
<div class="sect2">
<h3 id="_perinatal_care"><a class="anchor" href="#_perinatal_care"></a>7.1. Perinatal Care</h3>
<div class="sect3">
<h4 id="_proxy_module"><a class="anchor" href="#_proxy_module"></a>7.1.1. Proxy Module</h4>
<div class="listingblock">
<div class="content">
<pre>proxy
    Pregnant_patient

extend
    Core_patient

state :historical

    is_type1_diabetic: Boolean
        Result &lt;- has_diagnosis (73211009|diabetes mellitus|,
            |&lt;Current_episode.start|)

    previous_obstetric_hypertension: Boolean
        Result &lt;- has_diagnosis (367390009|hypertension in obstetric context|,
            |&lt; Current_episode.start|)

    previous_pre_eclampsia: Boolean
        Result &lt;- has_diagnosis (398254007|pre-eclampsia|,
            |&lt; Current_episode.start|)

    previous_eclampsia: Boolean
        Result &lt;- has_diagnosis (15938005|eclampsia|,
            |&lt; Current_episode.start|)

state :this_episode -- current pregnancy

    has_gestational_diabetes: Boolean
        Result &lt;- has_diagnosis (11687002|Gestational diabetes mellitus|,
            |&gt;= Current_episode.start|)

    has_pregnancy_hypertension: Boolean
        Result &lt;- has_diagnosis (367390009|hypertension in obstetric context|,
            |&gt;= Current_episode.start|)

    has_pre_eclampsia: Boolean
        Result &lt;- has_diagnosis (398254007|pre-eclampsia|,
            |&gt;= Current_episode.start|)

    has_eclampsia: Boolean
        Result &lt;- has_diagnosis (15938005|eclampsia|,
            |&gt;= Current_episode.start|)

    anaemia_type: Terminology_term
        Result &lt;-
            if not has_diagnosis (87522002|anaemia|, |&gt;= Current_episode.start|)
                |excluded|
            else
                diagnosis (87522002|anaemia|, |&gt;= Current_episode.start|)

state :live
    amniotic_fluid_state: Terminology_term

    uterine_fundal_height: Quantity

    vaginal_blood_flow: Quantity
        currency = 30mins
        ranges
            |critical_high|: &gt; 500 mL/hr

events
    haemorrhage:
        vaginal_blood_flow &lt;critical_high&gt;

    contractions_commenced:
        &lt;asserted&gt;

    braxton_hicks_contraction:
        &lt;asserted&gt;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_decision_module"><a class="anchor" href="#_decision_module"></a>7.1.2. Decision Module</h4>
<div class="listingblock">
<div class="content">
<pre>decision support module
    Obstetric_pregnancy

proxy
    P: Pregnant_patient

definitions

conditions

rules
    risk_evaluation: Terminology_term
        ....

    amniotic_fluid_risk: Terminology_term
        Result &lt;-
            map P.hypertension_state
                {44223004|premature rupture|,
                 86203003|polyhydramnios|}      -&gt; |obstetric emergency|9999
                {59566000|oligohydramnios|}     -&gt; |refer high risk care|1111
                {*}                             -&gt; |normal|0000

    hypertension_risk: Terminology_term
        if P.has_pre_eclampsia or P.has_eclampsia
            Result &lt;- |obstetric emergency|9999

        elseif P.previous_obstetric_hypertension or P.previous_pre_eclampsia or
                P.previous_eclampsia or P.has_pregnancy_hypertension
            Result &lt;- |refer high risk antenatal care|1111

        else
            Result &lt;- |normal|0000

    diabetes_risk: Terminology_term
        if P.has_gestational_diabetes
            Result &lt;- |refer high risk antenatal care|1111
        else
            Result &lt;- |normal|0000

    anaemia_risk: Terminology_term
        Result &lt;-
            map P.anaemia_type
                {27342004|anaemia of pregnancy|,
                 |severe|}                          -&gt; |obstetric emergency|9999
                {27342004|anaemia of pregnancy|}    -&gt; |refer high risk care|1111
                {*}                                 -&gt; |normal|0000</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_breast_cancer_decision_protocol"><a class="anchor" href="#_breast_cancer_decision_protocol"></a>7.2. Breast Cancer Decision Protocol</h3>
<div class="sect3">
<h4 id="_proxy_module_2"><a class="anchor" href="#_proxy_module_2"></a>7.2.1. Proxy module</h4>
<div class="paragraph">
<p>Breast cancer specific Proxy.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>proxy module
    Breast_cancer_patient

extend
    Cancer_patient

state
    tnm_t: String
        currency = 60 days

    tnm_n: String
        currency = 60 days

    tnm_m: String
        currency = 60 days

    tnm_g: String
        currency = 60 days

    estrogen_receptor: Terminology_term «pos_neg_vs»
        currency = 60 days

    progesterone_receptor:  Terminology_term «pos_neg_vs»
        currency = 60 days

    her2_expression: Terminology_term «pos_neg_vs»
        currency = 60 days

    ki67: Quantity
        currency = 60 days

    ejection_fraction: Quantity
        currency = 60 days

derived
    er_negative:
        estrogen_receptor = |negative|

    er_positive:
        estrogen_receptor = |positive|

    pr_negative:
        progesterone_receptor = |negative|

    pr_positive:
        progesterone_receptor = |positive|

    her2_negative:
        her2_expression = |negative|

    her2_positive:
        her2_expression = |positive|</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_decision_module_2"><a class="anchor" href="#_decision_module_2"></a>7.2.2. Decision Module</h4>
<div class="listingblock">
<div class="content">
<pre>decision support module
    Oncology_breast_cancer

proxy
    P: Breast_cancer_patient

definitions
    ki67_threshold: Quantity = 14%

conditions
    ki67_high:
        P.ki67 &gt;= ki67_threshold

    anthracyclines_contraindicated:
        P.has_diagnosis (|Transmural MI|) or
        P.ejection_fraction &lt; 40% or
        P.has_diagnosis ({|heart failure (class II)|,
                          |heart failure (class III)|,
                          |heart failure (class IV)|})

    taxanes_contraindicated:
        P.is_type1_diabetic or
        P.has_allergy (|taxanes|) or
        P.has_intolerance (|taxanes|)

rules
    molecular_subtype: Terminology_term
        if P.er_positive and P.her2_negative and not ki67_high
            Result &lt;- |Luminal A|

        elseif P.er_positive and P.her2_negative and ki67_high
            Result &lt;- |Luminal B (HER2 negative)|

        elseif P.er_positive and P.her2_positive
            Result &lt;- |Luminal B (HER2 positive)|

        elseif P.er_negative and P.pr_negative and P.her2_positive and ki67_high
            Result &lt;- |HER2|

        elseif P.er_negative and P.pr_negative and P.her2_negative and ki67_high
            Result &lt;- |Triple negative|

        else
            Result &lt;- |none|

    chemotherapy_regime: Terminology_term
        if not P.metastatic
            if molecular_subtype in {|Luminal B (HER2 negative)|, |Triple negative|} and
                    (P.tnm_t &gt; '1a' or P.tnm_n &gt; '0')
                Result &lt;- |taxanes|

            elseif molecular_subtype = |Luminal A| and
                    (P.tnm_t &gt;= '3' or P.tnm_n &gt;= '2' or P.tnm_g &gt;= '3')
                Result &lt;- |anthracyclines|

            elseif molecular_subtype = |Luminal B (HER2 positive)| and
                    (P.tnm_t = '1b' or P.tnm_t = '1c' and P.tnm_n = '0')
                    or
                    molecular_subtype = |HER2| and
                    (P.tnm_t = '1b' and P.tnm_n = '0')
                Result &lt;- |paditaxel + trastuzumab|
            else ...
                Result &lt;-

        else -- metastatic
            if ...
                Result &lt;-
            elseif ...
                Result &lt;-
            else
                Result &lt;-</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_decision_support_language_model_dslm"><a class="anchor" href="#_the_decision_support_language_model_dslm"></a>8. The Decision Support Language Model (DSLM)</h2>
<div class="sectionbody">
<div class="paragraph tbd">
<p>TBD: this section is a rough draft at the moment</p>
</div>
<div class="sect2">
<h3 id="_overview_3"><a class="anchor" href="#_overview_3"></a>8.1. Overview</h3>
<div class="paragraph">
<p>The <code>org.openehr.proc.dslm</code> package defines the Decision Support Language Model (DSLM), a structural model of the openEHR Decision Support language. It relies on the <a href="https://specifications.openehr.org/releases/LANG/latest/bmm.html" target="_blank" rel="noopener">openEHR BMM</a>.</p>
</div>
<div class="paragraph">
<p>The structure of the <code>dslm</code> packages is shown below.</p>
</div>
<div id="dslm_packages" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/PROC-dslm-packages.svg" alt="PROC dslm packages" width="50%">
</div>
<div class="title">Figure 4. proc.dslm Package</div>
</div>
<div class="paragraph">
<p>The packages are described below.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ds_module_package"><a class="anchor" href="#_ds_module_package"></a>8.2. DS Module Package</h3>
<div class="paragraph">
<p>The top-level construct of the DSLM is the <code>DS_MODULE</code>, representing a standalone decision support module. It is shown below.</p>
</div>
<div id="dslm_module" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/PROC-dslm.module.svg" alt="PROC dslm.module">
</div>
<div class="title">Figure 5. proc.dslm.module Package</div>
</div>
<div class="paragraph tbd">
<p>TBD: to be continued.</p>
</div>
<div class="sect3">
<h4 id="_class_descriptions"><a class="anchor" href="#_class_descriptions"></a>8.2.1. Class Descriptions</h4>
<div class="sect4">
<h5 id="_decision_module_class"><a class="anchor" href="#_decision_module_class"></a>8.2.1.1. DECISION_MODULE Class</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 33.3333%;">
<col style="width: 55.5556%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Class</strong></p></th>
<th class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>DECISION_MODULE</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Description</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><div class="content"><div class="paragraph">
<p>A container for a set of statements along with related BMM definitions, meta-data, terminology and bindings.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Inherit</strong></p></th>
<td class="tableblock halign-left valign-top" colspan="2"><p class="tableblock"><code>AUTHORED_RESOURCE</code>, <code>BMM_CLASS</code></p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Attributes</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>proxy_properties</strong>: <code>List&lt;BMM_PROPERTY&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Properties representing real-world objects, such as the patient state, the patient history (logical EHR) etc.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>definitions</strong>: <code>List&lt;BMM_CONSTANT&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Constant definitions needed by module.</p>
</div></div></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Functions</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Signature</strong></p></th>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>Meaning</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top"><p class="tableblock"><strong>0..1</strong></p></th>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>create_bmm_class</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Generate a <code>BMM_CLASS</code> structure in which:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><em>constants</em></code> = <code><em>this.definitions</em></code>;</p>
</li>
<li>
<p><code><em>this.conditions</em></code> are converted to <code>Boolean</code>-returning functions with no parameters whose <code><em>body</em></code> is a single assignment statement of the form <code>Result</code> = <code>DL_CONDITION_DEF.<em>definition</em></code>;</p>
</li>
<li>
<p><code><em>this.rules</em></code> are converted to <code>Boolean</code>-returning functions with no parameters whose <code><em>body</em></code> consists of the <code>DL_CONDITION_RULE.<em>body</em></code>.</p>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ds_rules_package"><a class="anchor" href="#_ds_rules_package"></a>8.3. DS Rules Package</h3>
<div class="paragraph">
<p>Specific Rule types are defined as descendants of <code>DS_RULE</code>, which may be understood as a pseudo form of the <code>BMM_FUNCTION</code> meta-type, i.e. a particular kind of function with a <code><em>body</em></code>. The following UML view illustrates.</p>
</div>
<div class="paragraph">
<p>Some specific rule types are described below.</p>
</div>
<div class="sect3">
<h4 id="_condition_chain_rule"><a class="anchor" href="#_condition_chain_rule"></a>8.3.1. Condition Chain Rule</h4>
<div class="paragraph">
<p>A DS <em>condition chain rule</em> is one that consists of a chain of condition / result pairs and an 'else' result to cover a failure to match any condition. It is illustrated in the following UML view.</p>
</div>
</div>
<div class="sect3">
<h4 id="_case_rule"><a class="anchor" href="#_case_rule"></a>8.3.2. Case Rule</h4>
<div class="paragraph">
<p>A DS <em>case rule</em> is one that obtains a value from an expression and determines the Result based on the interval in which the value falls. It is the equivalent of a 'case' statement in many languages. The match criterion on each branch of the rule is specified in terms of <code>C_PRIMITIVE</code> constraint types, from the <a href="https://specifications.openehr.org/releases/AM/latest/index">openEHR AOM2 model</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_class_descriptions_2"><a class="anchor" href="#_class_descriptions_2"></a>8.3.3. Class Descriptions</h4>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references"><a class="anchor" href="#_references"></a>References</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a id="GLIF"></a>Ohno-Machado, L., Gennari, J. H., Murphy, S. N., Jain, N. L., Tu, S. W., Oliver, D. E., Pattison-Gordon, E., et al. (1998). The GuideLine Interchange Format - A Model for Representing Guidelines. <em>J Am Med Inform Assoc</em>, 357–372.</p>
</div>
<div class="paragraph">
<p><a id="Samwald_arden_2012"></a>Samwald, M., Fehre, K., Bruin, J. de, &amp; Adlassnig, K.-P. (2012). The Arden Syntax standard for clinical decision support: Experiences and directions. <em>Journal of Biomedical Informatics</em>, <em>45</em>, 711–718. Retrieved from <a href="https://www.sciencedirect.com/science/article/pii/S1532046412000226" class="bare">https://www.sciencedirect.com/science/article/pii/S1532046412000226</a></p>
</div>
<div class="paragraph">
<p><a id="SuttonFox2003"></a>Sutton, D. R., &amp; Fox, J. (2003). The syntax and semantics of the PROforma guideline modeling language. <em>J Am Med Inform Assoc.</em>, <em>10(5)</em>, 433–443. Retrieved from <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC212780/" class="bare">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC212780/</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-06-29 10:48:58 +0100
</div>
</div>
</body>
</html>