<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<meta name="description" content="openEHR Task Planning Examples">
<meta name="keywords" content="task planning, examples, workflow">
<title>Task Planning Examples</title>
<link rel="stylesheet" href="https://specifications.openehr.org/styles/openehr.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_task_planning_examples">Task Planning Examples</a>
<ul class="sectlevel1">
<li><a href="#_amendment_record">Amendment Record</a></li>
<li><a href="#_acknowledgements">Acknowledgements</a>
<ul class="sectlevel2">
<li><a href="#_editors">Editors</a></li>
<li><a href="#_support">Support</a></li>
<li><a href="#_trademarks">Trademarks</a></li>
</ul>
</li>
<li><a href="#_preface">1. Preface</a>
<ul class="sectlevel2">
<li><a href="#_purpose">1.1. Purpose</a></li>
<li><a href="#_related_documents">1.2. Related Documents</a></li>
<li><a href="#_status">1.3. Status</a></li>
<li><a href="#_feedback">1.4. Feedback</a></li>
</ul>
</li>
<li><a href="#_overview">2. Overview</a>
<ul class="sectlevel2">
<li><a href="#_draw_io_tool_mode">2.1. Draw.io Tool mode</a></li>
</ul>
</li>
<li><a href="#_teamwork">3. Teamwork</a>
<ul class="sectlevel2">
<li><a href="#_out_patient_eye_clinic_encounter">3.1. Out-patient Eye Clinic Encounter</a>
<ul class="sectlevel3">
<li><a href="#_plan_overview">3.1.1. Plan Overview</a></li>
<li><a href="#_detailed_description">3.1.2. Detailed Description</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_order_management">4. Order Management</a>
<ul class="sectlevel2">
<li><a href="#_order_coordination">4.1. Order Coordination</a>
<ul class="sectlevel3">
<li><a href="#_plan_overview_2">4.1.1. Plan Overview</a></li>
<li><a href="#_detailed_description_2">4.1.2. Detailed Description</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_multi_drug_chemotherapy">5. Multi-drug Chemotherapy</a>
<ul class="sectlevel2">
<li><a href="#_limitations">5.1. Limitations</a></li>
<li><a href="#_plan_definition">5.2. Plan Definition</a></li>
<li><a href="#_rchops21_decision_logic_module">5.3. RCHOPS21 Decision Logic Module</a></li>
</ul>
</li>
<li><a href="#_antenatal_care">6. Antenatal Care</a>
<ul class="sectlevel2">
<li><a href="#_pregnancy_risk_assessment_dlm">6.1. Pregnancy Risk Assessment DLM</a></li>
</ul>
</li>
<li><a href="#_breast_cancer_decision_protocol">7. Breast Cancer Decision Protocol</a>
<ul class="sectlevel2">
<li><a href="#_decision_logic_module">7.1. Decision Logic Module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock text-center">
<div class="content">
<img src="https://specifications.openehr.org/images/openEHR_logo_RGB.svg" alt="openEHR logo">
</div>
</div>
</div>
</div>
<h1 id="_task_planning_examples" class="sect0"><a class="anchor" href="#_task_planning_examples"></a>Task Planning Examples</h1>
<div class="openblock partintro">
<div class="content">
<table class="tableblock frame-all grid-all fit-content spread">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2"><strong>Issuer</strong>: <a href="https://www.openehr.org/programs/specification" target="_blank" rel="noopener">openEHR Specification Program</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Release</strong>: PROC latest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Status</strong>: TRIAL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Revision</strong>: <a href="#latest_issue">[latest_issue]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Date</strong>: <a href="#latest_issue_date">[latest_issue_date]</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>Keywords</strong>: task planning, examples, workflow</p></td>
</tr>
</tbody>
</table>
<div class="imageblock text-center">
<div class="content">
<object type="image/svg+xml" data="openehr_block_diagram.svg" width="60%"><span class="alt">openEHR components</span></object>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">&#169; 2017 - 2020 The openEHR Foundation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><a href="https://www.openehr.org" target="_blank" rel="noopener">The openEHR Foundation</a> is an independent, non-profit foundation, facilitating the sharing of health records by consumers and clinicians via open specifications, clinical models and open platform implementations.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Licence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://specifications.openehr.org/images/cc-by-nd-88x31.png" alt="image"></span> Creative Commons Attribution-NoDerivs 3.0 Unported. <a href="https://creativecommons.org/licenses/by-nd/3.0/" class="bare">https://creativecommons.org/licenses/by-nd/3.0/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Support</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Issues: <a href="https://specifications.openehr.org/components/PROC/open_issues" target="_blank" rel="noopener">Problem Reports</a><br>
 Web: <a href="https://specifications.openehr.org" target="_blank" rel="noopener">specifications.openEHR.org</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_amendment_record"><a class="anchor" href="#_amendment_record"></a>Amendment Record</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 54.5454%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Issue</th>
<th class="tableblock halign-left valign-top">Details</th>
<th class="tableblock halign-left valign-top">Raiser</th>
<th class="tableblock halign-left valign-top">Completed</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>PROC Release 1.5.0</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>PROC Release 1.0.0</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue"></a>0.1.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Replace 'manual notification' callback by normal Handoff followed by manual notification Task wait state.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M Polajnar,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue_date"></a>16 Apr 2020</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial writing.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale,<br>
 B Næss</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">25 Apr 2019</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements"><a class="anchor" href="#_acknowledgements"></a>Acknowledgements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_editors"><a class="anchor" href="#_editors"></a>Editors</h3>
<div class="ulist">
<ul>
<li>
<p>Thomas Beale, Ars Semantica (UK); openEHR Foundation Management Board</p>
</li>
<li>
<p>Bjørn Næss, DIPS, Norway</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_support"><a class="anchor" href="#_support"></a>Support</h3>
<div class="paragraph">
<p>The work reported in this specification has been funded by the following organisations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>DIPS, Norway</p>
</li>
<li>
<p>Marand d.o.o., Slovenia</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_trademarks"><a class="anchor" href="#_trademarks"></a>Trademarks</h3>
<div class="ulist">
<ul>
<li>
<p>'openEHR' is a trademark of the openEHR Foundation.</p>
</li>
<li>
<p>'OMG' is a trademark of the Object Management Group.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preface"><a class="anchor" href="#_preface"></a>1. Preface</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose"><a class="anchor" href="#_purpose"></a>1.1. Purpose</h3>
<div class="paragraph">
<p>This document contains elaborated examples of the openEHR Task Planning (TP) Model, with diagrams in TP-VML.</p>
</div>
<div class="paragraph">
<p>The intended audience includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Task Plan and workflow authors;</p>
</li>
<li>
<p>Tool vendors.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_documents"><a class="anchor" href="#_related_documents"></a>1.2. Related Documents</h3>
<div class="paragraph">
<p>Prerequisite documents for reading this document include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://specifications.openehr.org/releases/PROC/latest/task_planning.html" target="_blank" rel="noopener">openEHR Task Planning Model</a>;</p>
</li>
<li>
<p>The <a href="https://specifications.openehr.org/releases/PROC/latest/tp_vml.html" target="_blank" rel="noopener">openEHR Task Planning Visual Modelling Language (TP-VML)</a>;</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_status"><a class="anchor" href="#_status"></a>1.3. Status</h3>
<div class="paragraph">
<p>This specification is in the TRIAL state. The development version of this document can be found at <a href="https://specifications.openehr.org/releases/PROC/latest/tp_examples.html" target="_blank" rel="noopener">https://specifications.openehr.org/releases/PROC/latest/tp_examples.html</a>.</p>
</div>
<div class="paragraph">
<p>Known omissions or questions are indicated in the text with a 'to be determined' paragraph, as follows:</p>
</div>
<div class="paragraph tbd">
<p><strong>TBD</strong>: (example To Be Determined paragraph)</p>
</div>
</div>
<div class="sect2">
<h3 id="_feedback"><a class="anchor" href="#_feedback"></a>1.4. Feedback</h3>
<div class="paragraph">
<p>Feedback may be provided on the <a href="https://discourse.openehr.org/c/specifications/task-planning-gdl" target="_blank" rel="noopener">process specifications forum</a>.</p>
</div>
<div class="paragraph">
<p>Issues may be raised on the <a href="https://specifications.openehr.org/components/PROC/open_issues" target="_blank" rel="noopener">specifications Problem Report tracker</a>.</p>
</div>
<div class="paragraph">
<p>To see changes made due to previously reported issues, see the <a href="https://specifications.openehr.org/components/PROC/history" target="_blank" rel="noopener">PROC component Change Request tracker</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>2. Overview</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_draw_io_tool_mode"><a class="anchor" href="#_draw_io_tool_mode"></a>2.1. Draw.io Tool mode</h3>
<div class="paragraph">
<p>The following files can be downloaded and then imported into draw.io as libraries to provide a working palette for TP-VML diagrams.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="tp_examples/draw.io-lib/TP_VML_plans.xml">TP_VML plans</a></p>
</li>
<li>
<p><a href="tp_examples/draw.io-lib/TP_VML_groups.xml">TP_VML groups</a></p>
</li>
<li>
<p><a href="tp_examples/draw.io-lib/TP_VML_tasks.xml">TP_VML tasks</a></p>
</li>
<li>
<p><a href="tp_examples/draw.io-lib/TP_VML_events.xml">TP_VML events</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_teamwork"><a class="anchor" href="#_teamwork"></a>3. Teamwork</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The examples in this section illustrate the use of TP for team-based work plans, including hand-offs, callbacks and other kinds of coordination.</p>
</div>
<div class="sect2">
<h3 id="_out_patient_eye_clinic_encounter"><a class="anchor" href="#_out_patient_eye_clinic_encounter"></a>3.1. Out-patient Eye Clinic Encounter</h3>
<div class="paragraph">
<p>This example is based on the original description of <a href="https://github.com/bjornna/TP-examples/blob/master/16-eye_outpatient/index.adoc">DIPS Eye encounter example</a>.</p>
</div>
<div id="outpatient_eye_clinic" class="imageblock text-center text-center">
<div class="content">
<img src="tp_examples/diagrams/outpatient_eye_clinic.svg" alt="outpatient eye clinic">
</div>
<div class="title">Figure 1. Outpatient eye clinic encounter</div>
</div>
<div class="sect3">
<h4 id="_plan_overview"><a class="anchor" href="#_plan_overview"></a>3.1.1. Plan Overview</h4>
<div class="paragraph">
<p>As for all Plans defined in the Task Planning formalism, it must be remembered that the Plan definition above is what the <em>TP engine executes</em>. It is the result of the execution (including worker allocation and communication, which is not shown in the definition) that causes workers in the real world to do things. Additionally, what the TP engine knows about the real world is limited to what it is told - many actions and events can occur outside the TP computing environment that will remain unknown to the system unless it is informed (e.g. by Manual notification).</p>
</div>
<div class="paragraph">
<p>The Work Plan consists of two top-level Task Plans, one for the patient and one for the clinic administrator / reception. The latter has two sub-plans linked by hand-off Tasks.</p>
</div>
<div class="paragraph">
<p>The purpose of the patient top-level Task Plan is to allow the system to notify the patient of the visit, via a reminder on the day of the visit, or some fixed time beforehand. The driving event is the calendar appointment, which is waited on by both the patient and the clinic admin Task Plans. It is assumed that longer term reminders, opportunities for changing appointments and so on are managed by another system that see the same calendar events, and is responsible for setting the calendar events in the first place. Thus, in the model above, the patient top-level plan is not really necessary (he/she will be notified by the appointment system), and is mainly included for purposes of demonstration.</p>
</div>
</div>
<div class="sect3">
<h4 id="_detailed_description"><a class="anchor" href="#_detailed_description"></a>3.1.2. Detailed Description</h4>
<div class="paragraph">
<p>The main work of the Work Plan is in the other three Task Plans, which essentially encode the following logic:</p>
</div>
<div class="paragraph">
<p>Clinic Administrator:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>clinic has a live Task Plan waiting on appointment A for patient P, at 2019-02-15 09:30:00;</p>
</li>
<li>
<p>when this calendar timepoint is reached, the TP system 'opens' the appointment via a System Request to the clinic appointment system (details not shown);</p>
</li>
<li>
<p>WAIT: the clinic Task Plan enters a new wait state for patient P, for appointment A;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Patient:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>patient arrives at clinic (modelled as a Manual notification);</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Clinic Administrator:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>receive patient, record presence;</p>
</li>
<li>
<p>Hand-off: pass to consultation (e.g. send to waiting area);</p>
</li>
<li>
<p>WAIT: until manual notification (patient returns)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Nurse:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>receive patient &amp; check EMR</p>
</li>
<li>
<p>review eye function, decide on whether to send to doc or not:</p>
<div class="ulist">
<ul>
<li>
<p>EITHER: return to reception</p>
</li>
<li>
<p>OR: pass to doctor</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Specialist:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>receive patient and check EMR</p>
</li>
<li>
<p>perform examination</p>
</li>
<li>
<p>update EMR</p>
</li>
<li>
<p>send patient back to reception.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_order_management"><a class="anchor" href="#_order_management"></a>4. Order Management</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The examples in this section illustrate the use of TP for order management, where openEHR Instructions and Actions (or other non-openEHR equivalents) are created and tracked.</p>
</div>
<div class="sect2">
<h3 id="_order_coordination"><a class="anchor" href="#_order_coordination"></a>4.1. Order Coordination</h3>
<div class="paragraph">
<p>This example is based on a standard Moscow City clinic protocol, and covers a 12 month period.</p>
</div>
<div id="order_coordination" class="imageblock text-center text-center">
<div class="content">
<img src="tp_examples/diagrams/order_coordination.svg" alt="order coordination">
</div>
<div class="title">Figure 2. GP order coordination</div>
</div>
<div class="sect3">
<h4 id="_plan_overview_2"><a class="anchor" href="#_plan_overview_2"></a>4.1.1. Plan Overview</h4>
<div class="paragraph">
<p>The Work Plan shown above defines the tasks for a 'standard health check' that includes a chest x-ray, a full blood panel and a hypertension checkup. The Plan executes over the periof a year, and consists of a health coordinator creating orders for the three items, via UI forms. The result of creating these orders will be the creation of a normal Composition and Instruction in the openEHR EHR for the patient. At some later point in time, the coordinator will action these orders, which will cause the EHR data to be used to create appropriate API calls / messages to the relevant target systems (radiology clinic, pathology lab, consultant) that will further cause appointments and attendances in the normal way by the patient. Each of these 'execute order' Tasks will block and wait for appropriate callbacks resulting from each of the orders being fulfilled and corresponding Actions being committed to the EHR (or else timeouts, if nothing happens). With the received results, the coordinator creates a health summary for the patient and commits that to the EHR.</p>
</div>
</div>
<div class="sect3">
<h4 id="_detailed_description_2"><a class="anchor" href="#_detailed_description_2"></a>4.1.2. Detailed Description</h4>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_multi_drug_chemotherapy"><a class="anchor" href="#_multi_drug_chemotherapy"></a>5. Multi-drug Chemotherapy</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section illustrates multi-drug chemotherapy with complex dosing and timing arrangements.</p>
</div>
<div class="paragraph">
<p>This example is based on the version of RCHOPS-21 documented by http:|nssg.oxford-haematology.org.uk/lymphoma/documents/lymphoma-chemo-protocols/L-80-r-chop-21.pdf[NHS Thames Valley Cancer Network].</p>
</div>
<div class="sect2">
<h3 id="_limitations"><a class="anchor" href="#_limitations"></a>5.1. Limitations</h3>
<div class="paragraph">
<p>The following elements of the plan are not yet included (mainly for brevity of the example):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Vincristine dose modification due to hepatic impairment;</p>
</li>
<li>
<p>Concurrent meds only shown in summarised form;</p>
</li>
<li>
<p>Exception pathways to handle patient reactions not shown.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_plan_definition"><a class="anchor" href="#_plan_definition"></a>5.2. Plan Definition</h3>
<div class="paragraph">
<p>The following shows the pre-medication phase.</p>
</div>
<div id="rchops_pre" class="imageblock text-center text-center">
<div class="content">
<img src="tp_examples/diagrams/RCHOPS21-pre.svg" alt="RCHOPS21 pre">
</div>
<div class="title">Figure 3. RCHOPS21 pre-med phase</div>
</div>
<div class="paragraph">
<p>The following shows the main regime, including conditional addition of Rituximab / methotrexate for high IPI patients.</p>
</div>
<div id="rchops_admin" class="imageblock text-center text-center">
<div class="content">
<img src="tp_examples/diagrams/RCHOPS21-admin.svg" alt="RCHOPS21 admin">
</div>
<div class="title">Figure 4. RCHOPS21 administration phase</div>
</div>
</div>
<div class="sect2">
<h3 id="_rchops21_decision_logic_module"><a class="anchor" href="#_rchops21_decision_logic_module"></a>5.3. RCHOPS21 Decision Logic Module</h3>
<div class="listingblock">
<div class="content">
<pre>dlm RCHOPS21

language
    original_language = &lt;[ISO_639-1::en]&gt;

description
    lifecycle_state = &lt;"unmanaged"&gt;
    original_author = &lt;
        ["name"] = &lt;"Dr Spock"&gt;
        ["organisation"] = &lt;"Acme healthcare"&gt;
        ["date"] = &lt;"2020-03-22"&gt;
    &gt;
    details = &lt;
        ["en"] = &lt;
            language = &lt;[ISO_639-1::en]&gt;
            purpose = &lt;"NHS CHOPS-21 chemotherapy guideline ...."&gt;
        &gt;
    &gt;

use
    BSA: Body_surface_area

preconditions
    has_lymphoma_diagnosis

reference
    paracetamol_dose: Quantity = 1g
    chlorphenamine_dose: Quantity = 10mg
    prednisolone_dose_per_m2: Quantity = 40mg
    rituximab_dose_per_m2: Quantity = 375mg
    doxorubicin_dose_per_m2: Quantity = 50mg
    vincristine_dose_per_m2: Quantity = 1.4mg
    cyclophosphamide_dose_per_m2: Quantity = 750mg
    cycle_period: Duration = 3w
    cycle_repeats: Integer = 6

input
    has_lymphoma_diagnosis: Boolean
        time_window = tw_current_episode

    staging: Terminology_term «ann_arbor_staging»
        currency = 30 days
        time_window = tw_current_episode

    has_metastases: Boolean
        currency = 30 days
        time_window = tw_current_episode

    neutrophils: Quantity
        currency = 3d
        ranges =
            ----------------------------------
            [normal]:      |&gt;1 x 10^9/L|,
            [low]:         |0.5 - 1 x 10^9/L|,
            [very_low]:    |&lt;0.5 x 10^9/L|
            ----------------------------------

    platelets: Quantity
        currency = 12h
        ranges =
            ----------------------------------
            [normal]:      |&gt;75 x 10^9/L|,
            [low]:         |50 - 74 x 10^9/L|,
            [very_low]:    |&lt;50 x 10^9/L|
            ----------------------------------

    bilirubin: Quantity
        currency = 12h
        ranges =
            ----------------------------------
            [normal]:      |&lt;20 mmol/L|,
            [high]:        |20 - 51 mmol/L|,
            [very_high]:   |51 - 85 mmol/L|,
            [crit_high]:   |&gt;85 mmol/L|
            ----------------------------------

    gfr: Quantity
        currency = 24h
        ranges =
            ----------------------------------
            [normal]:      |&gt;20 mL/min|,
            [low]:         |10 - 20 mL/min|,
            [very_low]:    |&lt;10 mL/min|
            ----------------------------------

    ldh: Quantity
        currency = 24h
        ranges =
            ----------------------------------
            [normal]:      |&gt;20 mL/min|,
            [low]:         |10 - 20 mL/min|,
            [very_low]:    |&lt;10 mL/min|
            ----------------------------------

conditions
    high_ipi:
        Result := ipi_risk ∈ {[ipi_high_risk], [ipi_intermediate_high_risk]}

    |
    | patient fit to undertake regime
    |
    patient_fit:
        Result := not
            (platelets.in_range ([very_low]) or
             neutrophils.in_range ([very_low]))

rules
    prednisolone_dose: Quantity
        Result := prednisolone_dose_per_m2 * BSA.bsa_m2

    rituximab_dose: Quantity
        Result := rituximab_dose_per_m2 * BSA.bsa_m2

    doxorubicin_dose: Quantity
        Result := doxorubicin_dose_per_m2 * BSA.bsa_m2
            * case bilirubin.range
                ===================
                [high]:        0.5,
                [very_high]:   0.25,
                [crit_high]:   0.0
                ===================

    prednisolone_dose: Quantity
        Result := prednisolone_dose_per_m2 * BSA.bsa_m2

    |
    | TODO: hepatic impairment dose modification
    |
    vincristine_dose: Quantity
        Result := vincristine_dose_per_m2 * BSA.bsa_m2

    |
    | CHECK: is low platelets and GFR dose modification
    | cumulative?
    |
    cyclophosphamide_dose: Quantity
        Result := cyclophosphamide_dose_per_m2 * BSA.bsa_m2
            * case platelets.range
                ===================
                [normal]:      1,
                [low]:         0.75
                ===================

            * case gfr.range
                ===================
                [normal]:      1,
                [low]:         0.75,
                [very_low]:    0.5
                ===================

    |
    | International Prognostic Index
    | ref: https:|en.wikipedia.org/wiki/International_Prognostic_Index
    |
    | One point is assigned for each of the following risk factors:
    |     Age greater than 60 years
    |     Stage III or IV disease
    |     Elevated serum LDH
    |     ECOG/Zubrod performance status of 2, 3, or 4
    |     More than 1 extranodal site
    |
    | The sum of the points allotted correlates with the following risk groups:
    |     Low risk (0-1 points) - 5-year survival of 73%
    |     Low-intermediate risk (2 points) - 5-year survival of 51%
    |     High-intermediate risk (3 points) - 5-year survival of 43%
    |     High risk (4-5 points) - 5-year survival of 26%
    |
    ipi_raw_score: Integer
        if age &gt; 60
            Result := Result + 1

        if staging ∈ {|stage III|, |stage IV|}
            Result := Result + 1

        if ldh.in_range ([normal])
            Result := Result + 1

        if ecog &gt; 1
            Result := Result + 1

        if extranodal_sites &gt; 1
            Result := Result + 1

    ipi_risk: Terminology_code
        Result :=
            map ipi_raw_score
                =======================================
                |0..1|  : [ipi_low_risk],
                |2|     : [ipi_intermediate_low_risk],
                |3|     : [ipi_intermediate_high_risk],
                |4..5|  : [ipi_high_risk]
                =======================================

terminology
    term_definitions = &lt;
        ["en"] = &lt;
            ["paracetamol_dose"] = &lt;
                text = &lt;"paracetamol dose"&gt;
                description = &lt;"paracetamol base dose level per sq. m of BSA"&gt;
            &gt;
            ["chlorphenamine_dose"] = &lt;
                text = &lt;"chlorphenamine dose"&gt;
                description = &lt;"chlorphenamine base dose level per sq. m of BSA"&gt;
            &gt;
            ...
            ["staging"] = &lt;
                text = &lt;"Cancer staging"&gt;
                description = &lt;"Cancer staging (Ann Arbor system)"&gt;
            &gt;
            ["has_metastases"] = &lt;
                text = &lt;"Metastatic status"&gt;
                description = &lt;"Status of metastasis of cancer"&gt;
            &gt;
            ...
            ["neutrophils"] = &lt;
                text = &lt;"neutrophils"&gt;
                description = &lt;"neutrophils level"&gt;
            &gt;
            ["platelets"] = &lt;
                text = &lt;"platelets"&gt;
                description = &lt;"platelets level"&gt;
            &gt;
            ...
            ["ipi_low_risk"] = &lt;
                text = &lt;"low risk: 5y survival - 73%"&gt;
                description = &lt;".."&gt;
            &gt;
            ["ipi_intermediate_low_risk"] = &lt;
                text = &lt;"intermediate-low risk: 5y survival - 51%"&gt;
                description = &lt;".."&gt;
            &gt;
            ["ipi_intermediate_high_risk"] = &lt;
                text = &lt;"intermediate-high risk: 5y survival - 43%"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["ipi_high_risk"] = &lt;
                text = &lt;"high risk: 5y survival - 26%"&gt;
                description = &lt;"..."&gt;
            &gt;
        &gt;
    &gt;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_antenatal_care"><a class="anchor" href="#_antenatal_care"></a>6. Antenatal Care</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_pregnancy_risk_assessment_dlm"><a class="anchor" href="#_pregnancy_risk_assessment_dlm"></a>6.1. Pregnancy Risk Assessment DLM</h3>
<div class="listingblock">
<div class="content">
<pre>dlm ruleset Obstetric_pregnancy

preconditions

    is_pregnant

input

    is_type1_diabetic: Boolean

    previous_obstetric_hypertension: Boolean

    previous_pre_eclampsia: Boolean

    previous_eclampsia: Boolean

    previous_gestational_diabetes: Boolean

    family_history_of_diabetes: Boolean

    race_related_diabetes_risk: Boolean

input -- &lt;time_window = tw_previous_episode&gt;

    previous_macrosomic_baby: Boolean

input -- &lt;time_window = tw_current_episode&gt;

    is_pregnant: Boolean

    has_gestational_diabetes: Boolean

    has_pregnancy_hypertension: Boolean

    has_pre_eclampsia: Boolean

    has_eclampsia: Boolean

    has_anaemia_of_pregnancy: Boolean

    bmi: Quantity
        ranges =
            ------------------------------------
            [high]:      |&gt;30 kg/m^2|,
            [normal]:    |&gt;=15 .. &lt;= 30 kg/m^2|,
            [low]:       |&lt; 15 kg/m^2|
            ------------------------------------

input

    amniotic_fluid_state: Terminology_term
        currency = 24h

    uterine_fundal_height: Quantity
        currency = 24h

    vaginal_blood_flow: Quantity
        currency = 30mins
        ranges =
            critical_high: |&gt; 500 mL/hr|

input -- &lt;source = "manual"&gt;

    haemorrhage: Boolean

    contractions_commenced: Boolean

    braxton_hicks_contraction: Boolean

rules

    anaemia_type: Terminology_term
        Result :=
            =====================================================
            not has_anaemia_of_pregnancy:  [excluded],
            -----------------------------------------------------
            *:                             [anaemia_of_pregnancy]
            =====================================================

    risk_evaluation: Terminology_term
        ....

    amniotic_fluid_risk: Terminology_term
        Result :=
            case amniotic_fluid_state
                ============================================
                [premature rupture],
                [polyhydramnios]:     [obstetric_emergency],
                --------------------------------------------
                [oligohydramnios]:    [refer_high_risk_care],
                --------------------------------------------
                *:                    [normal_obstetric_care]
                ============================================

    hypertension_risk: Terminology_term
        Result :=
            ===========================================================
            has_pre_eclampsia or
            has_eclampsia:                      [obstetric_emergency],
            -----------------------------------------------------------
            previous_obstetric_hypertension or
            previous_pre_eclampsia or
            previous_eclampsia or
            has_pregnancy_hypertension:         [refer_high_risk_care],
            -----------------------------------------------------------
            *:                                  [normal_obstetric_care]
            ===========================================================

    gestational_diabetes_risk: Boolean
        Result :=
            bmi.in_range ([high]) or
            previous_macrosomic_baby or
            previous_gestational_diabetes or
            family_history_of_diabetes or
            race_related_diabetes_risk

    anaemia_risk: Terminology_term
        Result :=
            case anaemia_type
                ======================================================
                [severe_anaemia_of_pregnancy]: [obstetric_emergency],
                ------------------------------------------------------
                [anaemia_of_pregnancy]:        [refer_high_risk_care],
                ------------------------------------------------------
                *:                             [normal_obstetric_care]
                ======================================================

terminology
    term_definitions = &lt;
        ["en"] = &lt;
            ["normal_obstetric_care"] = &lt;
                text = &lt;"Normal obstetric care"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["obstetric_emergency"] = &lt;
                text = &lt;"Obstetric emergency"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["refer_high_risk_care"] = &lt;
                text = &lt;"Refer to high risk care"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["premature_rupture"] = &lt;
                text = &lt;"Premature rupture of membranes"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["polyhydramnios"] = &lt;
                text = &lt;"polyhydramnios"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["oligohydramnios"] = &lt;
                text = &lt;"oligohydramnios"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["severe_anaemia_of_pregnancy"] = &lt;
                text = &lt;"anaemia of pregnancy, severe"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["anaemia_of_pregnancy"] = &lt;
                text = &lt;"anaemia of pregnancy"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["amniotic_fluid_risk"] = &lt;
                text = &lt;"Risk of pregnancy-related amniotic fluid"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["hypertension_risk"] = &lt;
                text = &lt;"Risk of pregnancy-related hypertension"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["diabetes_risk"] = &lt;
                text = &lt;"Risk of pregnancy-related diabetes"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["anaemia_risk"] = &lt;
                text = &lt;"Risk of pregnancy-related anaemia"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["previous_macrosomic_baby"] = &lt;
                text = &lt;"Baby weighing 4.5kg or above"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["previous_gestational_diabetes"] = &lt;
                text = &lt;"xxx"&gt;
                description = &lt;"..."&gt;
            &gt;
        &gt;
    &gt;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_breast_cancer_decision_protocol"><a class="anchor" href="#_breast_cancer_decision_protocol"></a>7. Breast Cancer Decision Protocol</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_decision_logic_module"><a class="anchor" href="#_decision_logic_module"></a>7.1. Decision Logic Module</h3>
<div class="listingblock">
<div class="content">
<pre>dlm guideline Oncology_breast_cancer.v0.5.0

input

    tnm_t: String
        currency = 60 days

    tnm_n: String
        currency = 60 days

    tnm_m: String
        currency = 60 days

    tnm_g: String
        currency = 60 days

    estrogen_receptor: Terminology_term «pos_neg_vs»
        currency = 60 days

    progesterone_receptor:  Terminology_term «pos_neg_vs»
        currency = 60 days

    her2_expression: Terminology_term «pos_neg_vs»
        currency = 60 days

    ki67: Quantity
        currency = 60 days
        ranges =
            -----------------
            high:   |&gt;= 14%|,
            normal: |&lt; 14%|
            -----------------

    ejection_fraction: Quantity
        currency = 60 days
        ranges =
            ------------------
            normal:  |&gt;= 40%|,
            low  :   |&lt; 40%|
            ------------------

conditions

    er_negative:
        estrogen_receptor = [negative]

    er_positive:
        estrogen_receptor = [positive]

    pr_negative:
        progesterone_receptor = [negative]

    pr_positive:
        progesterone_receptor = [positive]

    her2_negative:
        her2_expression = [negative]

    her2_positive:
        her2_expression = [positive]

    non_class_I_heart_failure:
        has_diagnosis ({[heart_failure_class_II],
                    [heart_failure_class_III],
                    [heart_failure_class_IV]})

    anthracyclines_contraindicated:
        has_diagnosis ([transmural_MI]) or
        ejection_fraction.in_range ([low]) or
        non_class_I_heart_failure

    taxanes_contraindicated:
        is_type1_diabetic or
        has_allergy ([taxanes]) or
        has_intolerance ([taxanes])

rules

    molecular_subtype: Terminology_term
        Result :=
            =========================================================
            er_positive and
            her2_negative and
            not ki67.in_range (high):    |Luminal A|,
            ---------------------------------------------------------
            er_positive and
            her2_negative and
            ki67.in_range (high):        [luminal_B_HER2_negative],
            ---------------------------------------------------------
            er_positive and
            her2_positive:               [luminal_B_HER2_positive],
            ---------------------------------------------------------
            er_negative and
            pr_negative and
            her2_positive and
            ki67.in_range (high):        [HER2],
            ---------------------------------------------------------
            er_negative and
            pr_negative and
            her2_negative and
            ki67.in_range (high):        [triple_negative],
            ---------------------------------------------------------
            *:                           [none]
            =========================================================

    chemotherapy_regime: Terminology_term
        Result :=
            ================================================================================
            not metastatic:
                    ========================================================================
                    molecular_subtype in
                        {[luminal_B_HER2_negative],
                         [triple_negative]} and
                    (tnm_t &gt; '1a' or tnm_n &gt; '0'):                   [taxanes],
                    ------------------------------------------------------------------------
                    molecular_subtype = [luminal_A] and
                    (tnm_t &gt;= '3' or tnm_n &gt;= '2' or tnm_g &gt;= '3'):  [anthracyclines],
                    ------------------------------------------------------------------------
                    molecular_subtype = [luminal_B_HER2_positive] and
                    (tnm_t = '1b' or tnm_t = '1c' and tnm_n = '0') or
                    molecular_subtype = [HER2_positive] and
                    (tnm_t = '1b' and tnm_n = '0'):                  [paditaxel_trastuzumab]
                    ========================================================================
            --------------------------------------------------------------------------------
            *:
                    =====================
                    yyy:        aaa,
                    ---------------------
                    xxx:        bbb,
                    ---------------------
                    *:
                    =====================
            ================================================================================

terminology
    term_definitions = &lt;
        ["en"] = &lt;
            ["luminal_A"] = &lt;
                text = &lt;"xxx"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["luminal_B_HER2_positive"] = &lt;
                text = &lt;"xxx"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["luminal_B_HER2_negative"] = &lt;
                text = &lt;"xxx"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["HER2_positive"] = &lt;
                text = &lt;"xxx"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["HER2_megative"] = &lt;
                text = &lt;"xxx"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["triple_negative"] = &lt;
                text = &lt;"xxx"&gt;
                description = &lt;"..."&gt;
            &gt;
            ["oligohydramnios"] = &lt;
                text = &lt;"xxx"&gt;
                description = &lt;"..."&gt;
            &gt;</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-08-30 18:20:39 +0100
</div>
</div>
</body>
</html>